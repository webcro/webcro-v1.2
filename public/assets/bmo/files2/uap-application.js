(function(){var r=window.angular,f=r.module("com.td.tdi.uapWeb","com.td.tdi.otpWeb com.td.oca.alertBrowseHappy com.td.oca.coreI18n com.td.oca.coreRouter com.td.oca.uiNavigation com.td.oca.brandingThemeSwitcher ngCookies ngAria".split(" ")),w={easyweb:"app.login.easyweb-getting-started",webbroker:"app.login.webbroker-getting-started",wbrad:"app.login.webbroker-getting-started",securekey:"app.login.secure.secure-login",generic:"app.login.secure.generic-login"};f.constant("UAP_CONSTANTS",{DEFAULT_STATE:"app.login.secure.generic-login",
HEADER_DOMAIN:"domainName",HEADER_LOCALE:"Accept-Language",HEADER_TEST_SET:"ConsumerApplication.From.Address",COOKIE_AUTHENTICATION_CONTEXT:"authenticationContextInfo",COOKIE_OG_DOMAIN:"td.com",COOKIE_OG_REQUIRED:"ogRequired",COOKIE_OG_NAME:"ogCookieName",COOKIE_RESUME_PATH:"resumePath",THIRD_PARTY_RETURN:"thirdParty",CONFIGURATION_LOOKUP_URI:"configuration-lookup",FORM_NAME_LOCALE:"locale",FORM_NAME_REFERENCE_ID:"referenceId",FORM_NAME_REFERENCE_ID_PING:"REF",CONSUMER_KEY:"consumer",LOCALE_KEY:"locale"});
f.constant("CONSUMER_TITLES",{easyweb_en_CA:"EasyWeb Login",easyweb_fr_CA:"Se connecter \x26agrave; BanqueNet",webbroker_en_CA:"WebBroker Login",webbroker_fr_CA:"Se connecter \x26agrave; CourtierWeb",wbrad_en_CA:"WebBroker Login",wbrad_fr_CA:"Se connecter \x26agrave; CourtierWeb",generic_en_CA:"TD Login",generic_fr_CA:"Se connecter \x26agrave; TD"});f.factory("uapHttpInterceptor",["$rootScope","$injector","UAP_CONSTANTS",function(c,n,m){return{request:function(k){if(r.isUndefined(c.consumer))for(var a=
window.location.search.substring(1).split("\x26"),p=0;p<a.length;p++){var g=a[p].split("\x3d");"consumer"==decodeURIComponent(g[0])&&(c.consumer=g[1])}a=n.get("$translate");k.headers[m.HEADER_LOCALE]=a.use();k.headers[m.HEADER_DOMAIN]=c.consumer;return k}}}]);f.config(["$httpProvider","$translateProvider","$translatePartialLoaderProvider","$compileProvider",function(c,n,m,k){c.interceptors.push("uapHttpInterceptor");k.debugInfoEnabled(!1)}]);f.service("configurationService",["$http","$q","UAP_CONSTANTS",
function(c,n,m){this.getConfigurationValues=function(){var k=n.defer();c({method:"GET",url:m.CONFIGURATION_LOOKUP_URI}).success(function(c,m,g,e){k.resolve(c)});return k.promise}}]);f.run(["$rootScope","$cookies","$http","$translate","$translatePartialLoader","$state","OTP_UTIL","UAP_CONSTANTS","configurationService","$timeout","CONSUMER_TITLES",function(c,n,m,k,a,p,g,e,f,x,t){var y={CHALLENGE_SETUP:{name:"app.mfa-setup",data:{}},CHALLENGE_UPDATE:{name:"app.mfa-update",data:{}},CHALLENGE_OTP_SETUP_CONSENT:{name:"app.setup.existing-new-customer",
data:{}},OTP_UPDATE:{name:"app.setup.setup-complete",data:{update:!0,flowMode:g.FLOW_MODES.otpUpdateFlow}},PASSWORD_EXPIRED:{name:"app.maintenance.update-password",data:{isCustomer:!0}},FORGOT_PASSWORD:{name:"app.reset.username-password-help",data:{}}},l=n.get(e.COOKIE_AUTHENTICATION_CONTEXT).split("\x26"),q={};for(a=0;a<l.length;a++){var u=l[a].split("\x3d");q[u[0]]=u[1]}f.getConfigurationValues().then(function(b){b=b.configurationValues;for(var h in b)for(var d in b[h])b[h].hasOwnProperty(d)&&(c[d]=
b[h][d]);m.defaults.headers.common[e.HEADER_DOMAIN]=c.consumer;r.isUndefined(c.tsnConsumerAppId)||"null"==c.tsnConsumerAppId||(m.defaults.headers.common[e.HEADER_TEST_SET]=c.tsnConsumerAppId);if(-1< !window.location.search.indexOf(e.LOCALE_KEY)&&-1< !window.location.search.indexOf(e.CONSUMER_KEY)){h={};h[e.CONSUMER_KEY]=c.consumer;h[e.LOCALE_KEY]=c.lang;d=document.location.search.substr(1).split("\x26");void 0===d&&d==[];for(var a in h){b=h[a];a=escape(a);b=escape(b);for(var f=d.length,g;f--;)if(g=
d[f].split("\x3d"),g[0]==a){g[1]=b;d[f]=g.join("\x3d");break}0>f&&(d[d.length]=[a,b].join("\x3d"))}d=d.filter(function(b){return""!==b});document.location.search=d.join("\x26")}k.use(c.lang);a=w[c.consumer];h=function(){x(function(){var b=q.ec;b&&"undefined"!==b&&"null"!==b&&c.$broadcast("initialError.ec",b)})};d=n.get("uap_function");var l;d&&(l=y[d.toUpperCase()]);l?p.go(l.name,l.data):a?p.baseGo(a).then(h):p.baseGo(e.DEFAULT_STATE).then(h)});var v=function(b,a){v=function(){};"true"==q[e.COOKIE_OG_REQUIRED]&&
(document.cookie=q[e.COOKIE_OG_NAME]+"\x3d"+a.sessionToken+"; path\x3d/; domain\x3d"+e.COOKIE_OG_DOMAIN);if(q[e.COOKIE_RESUME_PATH]==e.THIRD_PARTY_RETURN){var d=$("\x3cform\x3e",{id:"shibbolethTransferOutForm",method:"post",action:window.location.protocol+"//"+window.location.hostname+c.ThirdPartyResumePath});b=$("\x3cinput\x3e").attr("type","hidden");var h=$("\x3cinput\x3e").attr("type","hidden");$(b).attr("name",e.FORM_NAME_REFERENCE_ID);$(h).attr("name",e.FORM_NAME_LOCALE);$(b).val(a.REF);$(h).val(k.use());
d=d.append(b);d=d.append(h)}else b="uap_locale\x3d"+k.use()+"; path\x3d/; domain\x3d.td.com",document.cookie=b,d=$("\x3cform\x3e",{id:"pingTransferOutForm",method:"get",action:c.Ping_Domain+q[e.COOKIE_RESUME_PATH]}),b=$("\x3cinput\x3e").attr("type","hidden"),$(b).attr("name",e.FORM_NAME_REFERENCE_ID_PING),$(b).val(a.REF),d=d.append(b);d.appendTo(document.body).submit()};f=function(b){b=$("\x3cform\x3e",{id:"cancelOutForm",method:"post",action:window.location.protocol+"//"+window.location.hostname+
c.ThirdPartyResumePath});var a=$("\x3cinput\x3e").attr("type","hidden");$(a).attr("name",e.FORM_NAME_LOCALE);$(a).val(k.use());b=b.append(a);b.appendTo(document.body).submit()};l=[g.EVENTS.authSuccessEvent];g=[g.EVENTS.loginCancelled];for(a=0;a<l.length;a++)c.$on(l[a],v);for(a=0;a<g.length;a++)c.$on(g[a],f);c.$on("$translateChangeSuccess",function(b,a,d){(b=t[c.consumer+"_"+a.language])?document.querySelector("title").innerHTML=b:document.querySelector("title").innerHTML=t["generic_"+a.language]})}])})();
//# sourceMappingURL=uap-application.min.js.map